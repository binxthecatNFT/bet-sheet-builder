<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Bet Sheet Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --sheet-width: 1200px;
      --sheet-height: 675px;

      --sheet-bg-main: #20274a;
      --text-main: #ffffff;
      --text-muted: #c2cade;

      /* 3-player card defaults */
      --card1-color: #6b1118;
      --card2-color: #6b3a11;
      --card3-color: #0c2650;

      /* Parlay sheet variables */
      --parlay-text-color: #ffffff;
      --parlay-text-size: 34px;
      --parlay-font: "Bebas Neue", sans-serif;

      --t1-left: 5%;   /* bottom text (week 13) */
      --t1-bottom: 4%;
      --t2-left: 5%;   /* top text (@handle) */
      --t2-bottom: 86%;

      --slip-left: 5%;
      --slip-top: 10%;
      --slip-width: 35%;

      --player-right: 8%;
      --player-bottom: 0%;
      --player-width: 32%;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 20px;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, var(--sheet-bg-main), #050816 60%);
      color: var(--text-main);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .app-header {
      width: 100%;
      max-width: var(--sheet-width);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 8px;
      font-size: 13px;
      color: var(--text-muted);
    }

    .app-header-left { flex: 1 1 auto; }

    .app-header-controls {
      display: flex;
      flex-direction: column;
      gap: 6px;
      align-items: flex-end;
    }

    select {
      background: rgba(0,0,0,0.85);
      color: #fff;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.3);
      padding: 4px 10px;
      font-size: 13px;
      outline: none;
    }

    .control-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      justify-content: flex-end;
      align-items: center;
    }

    .pill {
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(0,0,0,0.45);
      border: 1px solid rgba(255,255,255,0.2);
      white-space: nowrap;
    }

    .pill input[type="color"] {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      border: none;
      padding: 0;
      cursor: pointer;
      background: transparent;
    }

    .pill input[type="range"] {
      width: 90px;
    }

    .pill input[type="number"] {
      width: 52px;
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,0.35);
      background: rgba(0,0,0,0.6);
      color: #fff;
      padding: 2px 4px;
      font-size: 12px;
    }

    .pill select {
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,0.35);
      background: rgba(0,0,0,0.8);
      color: #fff;
      padding: 2px 6px;
      font-size: 12px;
    }

    .btn-primary {
      border: none;
      padding: 8px 16px;
      border-radius: 999px;
      background: linear-gradient(135deg, #ff8a3a, #ff4f58);
      color: #fff;
      font-weight: 700;
      font-size: 13px;
      cursor: pointer;
      box-shadow: 0 6px 14px rgba(0,0,0,0.5);
      white-space: nowrap;
    }

    .btn-primary:active {
      transform: translateY(1px);
      box-shadow: 0 3px 8px rgba(0,0,0,0.7);
    }

    .helper-note {
      max-width: var(--sheet-width);
      width: 100%;
      text-align: right;
      font-size: 12px;
      color: var(--text-muted);
    }

    #sheet {
      width: var(--sheet-width);
      height: var(--sheet-height);
      border-radius: 20px;
      background: radial-gradient(circle at top, var(--sheet-bg-main), #050816 60%);
      box-shadow: 0 20px 40px rgba(0,0,0,0.8);
      overflow: hidden;
      position: relative;
    }

    .template {
      width: 100%;
      height: 100%;
      display: none;
    }
    .template.active { display: block; }

    /* Generic image-slot styling */
    .image-slot {
      position: relative;
      cursor: pointer;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.45);
    }

    .image-slot::before {
      content: "";
      position: absolute;
      inset: 14%;
      border-radius: 12px;
      border: 2px dashed rgba(255,255,255,0.85);
      pointer-events: none;
    }

    .upload-ui {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      gap: 6px;
      text-align: center;
    }

    .upload-ui .plus {
      font-size: 60px;
      color: #fff;
      text-shadow: 0 0 16px rgba(0,0,0,0.9);
    }

    .upload-ui .label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: rgba(255,255,255,0.95);
    }

    .image-slot img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: opacity 0.2s;
      pointer-events: none;
    }

    .image-slot.has-image::before { display: none; }
    .image-slot.has-image .upload-ui { display: none; }
    .image-slot.has-image img { opacity: 1; }

    .image-slot input[type="file"] { display: none; }

    /* 3-PLAYER TEMPLATE ------------------------------------ */
    .sheet-header {
      text-align: center;
      margin-bottom: 18px;
      text-transform: uppercase;
    }

    .sheet-subtitle {
      font-family: "Bebas Neue", sans-serif;
      font-size: 30px;
      letter-spacing: 2px;
    }

    .sheet-title {
      font-family: "Bebas Neue", sans-serif;
      font-size: 68px;
      letter-spacing: 3px;
      margin: 4px 0;
    }

    .sheet-kicker {
      font-size: 22px;
      color: var(--text-muted);
    }

    .player-grid {
      display: flex;
      gap: 16px;
      height: calc(100% - 110px);
    }

    .player-card {
      flex: 1;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.15);
      display: flex;
      flex-direction: column;
      background: linear-gradient(var(--card1-color), #000000);
    }

    .player-card[data-card="1"] { background: linear-gradient(var(--card1-color), #000); }
    .player-card[data-card="2"] { background: linear-gradient(var(--card2-color), #000); }
    .player-card[data-card="3"] { background: linear-gradient(var(--card3-color), #000); }

    .player-image-slot { height: 230px; }

    .player-body {
      padding: 10px 14px 14px;
    }

    .player-name {
      font-family: "Bebas Neue", sans-serif;
      font-size: 28px;
      text-align: center;
      margin-bottom: 6px;
      letter-spacing: 2px;
    }

    .player-bet {
      text-align: center;
      padding: 6px 10px;
      border-radius: 8px;
      font-weight: 700;
      margin: 0 auto 10px;
      width: 90%;
      background: rgba(0,0,0,0.45);
    }

    .player-notes {
      font-size: 14px;
      margin-left: 18px;
      padding-left: 8px;
    }

    .player-notes li + li { margin-top: 4px; }

    /* PARLAY TEMPLATE -------------------------------------- */
    .template-parlay { position: relative; }

    .parlay-wrapper {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: 18px;
      overflow: hidden;
    }

    .template-parlay .image-slot { background: transparent; }

    .parlay-bg-slot {
      position: absolute;
      inset: 0;
      z-index: 1;
      background-size: cover;
      background-position: center;
    }

    .parlay-bg-slot img { object-fit: cover; }

    .parlay-slip-slot {
      position: absolute;
      left: var(--slip-left);
      top: var(--slip-top);
      width: var(--slip-width);
      height: 80%;
      border-radius: 18px;
      background: #101010;
      box-shadow: 0 14px 30px rgba(0,0,0,0.8);
      z-index: 2;
      padding: 8px;
    }

    .parlay-slip-slot img { object-fit: contain; }

    .parlay-player-slot {
      position: absolute;
      right: var(--player-right);
      bottom: var(--player-bottom);
      width: var(--player-width);
      height: 95%;
      border-radius: 0;
      background: transparent;
      border: none;
      z-index: 4; /* ALWAYS above slip & bg */
    }

    .parlay-player-slot img { object-fit: contain; }

    .parlay-bottom-text {
      position: absolute;
      font-family: var(--parlay-font);
      font-size: var(--parlay-text-size);
      letter-spacing: 3px;
      text-transform: uppercase;
      color: var(--parlay-text-color);
      text-shadow: 0 2px 8px rgba(0,0,0,0.9);
      white-space: nowrap;
      z-index: 5;
    }

    .parlay-text-1 { left: var(--t1-left); bottom: var(--t1-bottom); }
    .parlay-text-2 { left: var(--t2-left); bottom: var(--t2-bottom); }

    .editable {
      outline: none;
      cursor: text;
    }
    .editable:empty::before {
      content: attr(data-placeholder);
      opacity: 0.4;
    }

    @media (max-width: 1300px) {
      #sheet { transform: scale(0.8); transform-origin: top center; }
    }
    @media (max-width: 1000px) {
      #sheet { transform: scale(0.65); }
    }
    @media (max-width: 750px) {
      body { padding: 12px; }
      #sheet { transform: scale(0.5); }
    }
  </style>
</head>
<body>
  <div class="app-header">
    <div class="app-header-left">
      Edit any text and click the dotted boxes with the big <strong>+</strong> to upload images.
    </div>

    <div class="app-header-controls">
      <div class="control-row">
        <select id="template-select">
          <option value="three" selected>3-Player Props</option>
          <option value="parlay">Parlay + Player</option>
        </select>

        <label class="pill">
          BG
          <input type="color" id="bg-color-picker" value="#20274a" />
        </label>

        <label class="pill">
          BG Preset
          <select id="bg-template-select">
            <option value="none" selected>None / Upload</option>
            <option value="stadium-blue">Stadium Blue</option>
            <option value="stadium-green">Stadium Green</option>
            <option value="dark-gradient">Dark Gradient</option>
          </select>
        </label>
      </div>

      <div id="card-color-controls" class="control-row">
        <label class="pill">
          Box 1
          <input type="color" id="card1-color" value="#6b1118" />
        </label>
        <label class="pill">
          Box 2
          <input type="color" id="card2-color" value="#6b3a11" />
        </label>
        <label class="pill">
          Box 3
          <input type="color" id="card3-color" value="#0c2650" />
        </label>
      </div>

      <div id="parlay-style-controls" class="control-row" style="display:none;">
        <label class="pill">
          Font
          <select id="parlay-font-select">
            <option value="'Bebas Neue', sans-serif">Bebas</option>
            <option value="'Inter', sans-serif">Inter</option>
            <option value="system-ui, sans-serif">System</option>
          </select>
        </label>
        <label class="pill">
          Text color
          <input type="color" id="parlay-text-color" value="#ffffff" />
        </label>
        <label class="pill">
          Size
          <input type="number" id="parlay-text-size" min="18" max="60" value="34" />
        </label>
        <label class="pill">
          Text1 X
          <input type="range" id="text1-x" min="0" max="100" value="5" />
        </label>
        <label class="pill">
          Text1 Y
          <input type="range" id="text1-y" min="0" max="40" value="4" />
        </label>
        <label class="pill">
          Text2 X
          <input type="range" id="text2-x" min="0" max="100" value="5" />
        </label>
        <label class="pill">
          Text2 Y
          <input type="range" id="text2-y" min="0" max="90" value="86" />
        </label>
        <label class="pill">
          Slip X
          <input type="range" id="slip-x" min="0" max="30" value="5" />
        </label>
        <label class="pill">
          Slip Y
          <input type="range" id="slip-y" min="0" max="25" value="10" />
        </label>
        <label class="pill">
          Slip width
          <input type="range" id="slip-width" min="25" max="60" value="35" />
        </label>
        <label class="pill">
          Player X
          <input type="range" id="player-x" min="0" max="50" value="8" />
        </label>
        <label class="pill">
          Player Y
          <input type="range" id="player-y" min="0" max="25" value="0" />
        </label>
        <label class="pill">
          Player width
          <input type="range" id="player-width" min="20" max="50" value="32" />
        </label>
      </div>

      <button id="download-btn" class="btn-primary">Download image</button>
    </div>
  </div>

  <div class="helper-note">
    Parlay template: use a PNG player with transparent background for best overlap.
  </div>

  <div id="sheet">
    <!-- 3-PLAYER TEMPLATE -->
    <div id="template-three" class="template active">
      <div class="sheet-header">
        <div class="sheet-subtitle editable" contenteditable="true">CASHIN SLIP'S</div>
        <div class="sheet-title editable" contenteditable="true">NBA HIT RATES</div>
        <div class="sheet-kicker editable" contenteditable="true">3/3 PLAYER PROPS</div>
      </div>

      <div class="player-grid">
        <div class="player-card" data-card="1">
          <div class="image-slot player-image-slot">
            <div class="upload-ui">
              <span class="plus">+</span>
              <span class="label">Upload player image</span>
            </div>
            <img alt="Player 1" />
            <input type="file" accept="image/*" />
          </div>
          <div class="player-body">
            <div class="player-name editable" contenteditable="true">PLAYER ONE</div>
            <div class="player-bet editable" contenteditable="true">Over 11.5 Points -119</div>
            <ul class="player-notes">
              <li class="editable" contenteditable="true">Hit 5 of last 5</li>
              <li class="editable" contenteditable="true">Favorable matchup</li>
              <li class="editable" contenteditable="true">Playing 30+ minutes</li>
            </ul>
          </div>
        </div>

        <div class="player-card" data-card="2">
          <div class="image-slot player-image-slot">
            <div class="upload-ui">
              <span class="plus">+</span>
              <span class="label">Upload player image</span>
            </div>
            <img alt="Player 2" />
            <input type="file" accept="image/*" />
          </div>
          <div class="player-body">
            <div class="player-name editable" contenteditable="true">PLAYER TWO</div>
            <div class="player-bet editable" contenteditable="true">Over 9.5 Points -113</div>
            <ul class="player-notes">
              <li class="editable" contenteditable="true">High usage lately</li>
              <li class="editable" contenteditable="true">Weak defense vs position</li>
              <li class="editable" contenteditable="true">Solid minutes floor</li>
            </ul>
          </div>
        </div>

        <div class="player-card" data-card="3">
          <div class="image-slot player-image-slot">
            <div class="upload-ui">
              <span class="plus">+</span>
              <span class="label">Upload player image</span>
            </div>
            <img alt="Player 3" />
            <input type="file" accept="image/*" />
          </div>
          <div class="player-body">
            <div class="player-name editable" contenteditable="true">PLAYER THREE</div>
            <div class="player-bet editable" contenteditable="true">Over 14.5 Points -105</div>
            <ul class="player-notes">
              <li class="editable" contenteditable="true">High shot volume</li>
              <li class="editable" contenteditable="true">30+ minutes nightly</li>
              <li class="editable" contenteditable="true">Great matchup</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- PARLAY TEMPLATE -->
    <div id="template-parlay" class="template template-parlay">
      <div class="parlay-wrapper">
        <!-- Background -->
        <div class="image-slot parlay-bg-slot">
          <div class="upload-ui">
            <span class="plus">+</span>
            <span class="label">Upload background image</span>
          </div>
          <img alt="Background" />
          <input type="file" accept="image/*" />
        </div>

        <!-- Slip -->
        <div class="image-slot parlay-slip-slot">
          <div class="upload-ui">
            <span class="plus">+</span>
            <span class="label">Upload parlay image</span>
          </div>
          <img alt="Parlay slip" />
          <input type="file" accept="image/*" />
        </div>

        <!-- Player -->
        <div class="image-slot parlay-player-slot">
          <div class="upload-ui">
            <span class="plus">+</span>
            <span class="label">Upload player PNG</span>
          </div>
          <img alt="Player" />
          <input type="file" accept="image/*" />
        </div>

        <!-- Two movable text sections -->
        <div class="parlay-bottom-text parlay-text-1 editable" contenteditable="true">
          WEEK 13 PARLAYS
        </div>
        <div class="parlay-bottom-text parlay-text-2 editable" contenteditable="true">
          @LETSCASHSLIPS
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    // Helper
    function shadeColor(color, amount) {
      const num = parseInt(color.slice(1), 16);
      let r = (num >> 16) + amount;
      let g = ((num >> 8) & 0x00ff) + amount;
      let b = (num & 0x0000ff) + amount;
      r = Math.min(255, Math.max(0, r));
      g = Math.min(255, Math.max(0, g));
      b = Math.min(255, Math.max(0, b));
      return "#" + (r << 16 | g << 8 | b).toString(16).padStart(6, "0");
    }

    // Image uploads
    document.querySelectorAll(".image-slot").forEach(slot => {
      const input = slot.querySelector("input[type='file']");
      const img = slot.querySelector("img");
      if (!input || !img) return;

      slot.addEventListener("click", () => input.click());

      input.addEventListener("change", e => {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = ev => {
          img.src = ev.target.result;
          slot.classList.add("has-image");
        };
        reader.readAsDataURL(file);
      });
    });

    // Background color
    const sheet = document.getElementById("sheet");
    const bgPicker = document.getElementById("bg-color-picker");
    function applyBg(color) {
      document.documentElement.style.setProperty("--sheet-bg-main", color);
      document.body.style.background =
        `radial-gradient(circle at top, ${color}, #050816 60%)`;
      sheet.style.background =
        `radial-gradient(circle at top, ${color}, #050816 60%)`;
    }
    applyBg(bgPicker.value);
    bgPicker.addEventListener("input", e => applyBg(e.target.value));

    // BG presets for parlay
    const bgTemplateSelect = document.getElementById("bg-template-select");
    const parlayBgSlot = document.querySelector(".parlay-bg-slot");
    function applyBgTemplate(value) {
      if (!parlayBgSlot) return;
      let bg = "#111";
      if (value === "stadium-blue") {
        bg = "radial-gradient(circle at top, #1b3f84 0%, #020614 55%), linear-gradient(to top, #0b0f22 15%, transparent 45%)";
      } else if (value === "stadium-green") {
        bg = "linear-gradient(to top, #0b5c2b 8%, transparent 40%), radial-gradient(circle at top, #1a3c7a 0%, #030814 55%)";
      } else if (value === "dark-gradient") {
        bg = "radial-gradient(circle at top, #391a5f 0%, #050816 60%)";
      }
      parlayBgSlot.style.background = bg;
    }
    applyBgTemplate(bgTemplateSelect.value);
    bgTemplateSelect.addEventListener("change", e => applyBgTemplate(e.target.value));

    // 3-player card colors
    function applyCardColor(cardIndex, color) {
      document.documentElement.style.setProperty(`--card${cardIndex}-color`, color);
    }
    const c1 = document.getElementById("card1-color");
    const c2 = document.getElementById("card2-color");
    const c3 = document.getElementById("card3-color");
    applyCardColor(1, c1.value);
    applyCardColor(2, c2.value);
    applyCardColor(3, c3.value);
    c1.addEventListener("input", e => applyCardColor(1, e.target.value));
    c2.addEventListener("input", e => applyCardColor(2, e.target.value));
    c3.addEventListener("input", e => applyCardColor(3, e.target.value));

    // Template switching
    const templateSelect = document.getElementById("template-select");
    const tplThree = document.getElementById("template-three");
    const tplParlay = document.getElementById("template-parlay");
    const cardControls = document.getElementById("card-color-controls");
    const parlayControls = document.getElementById("parlay-style-controls");

    function setTemplate(name) {
      const isThree = name === "three";
      tplThree.classList.toggle("active", isThree);
      tplParlay.classList.toggle("active", !isThree);
      cardControls.style.display = isThree ? "flex" : "none";
      parlayControls.style.display = isThree ? "none" : "flex";
    }
    setTemplate(templateSelect.value);
    templateSelect.addEventListener("change", e => setTemplate(e.target.value));

    // Parlay text style & position
    const fontSelect = document.getElementById("parlay-font-select");
    const textColorInput = document.getElementById("parlay-text-color");
    const textSizeInput = document.getElementById("parlay-text-size");
    const text1 = document.querySelector(".parlay-text-1");
    const text2 = document.querySelector(".parlay-text-2");
    const text1X = document.getElementById("text1-x");
    const text1Y = document.getElementById("text1-y");
    const text2X = document.getElementById("text2-x");
    const text2Y = document.getElementById("text2-y");

    function applyParlayTextStyle() {
      document.documentElement.style.setProperty("--parlay-text-color", textColorInput.value);
      document.documentElement.style.setProperty("--parlay-text-size", textSizeInput.value + "px");
      document.documentElement.style.setProperty("--parlay-font", fontSelect.value);
    }

    function applyParlayTextPositions() {
      document.documentElement.style.setProperty("--t1-left", text1X.value + "%");
      document.documentElement.style.setProperty("--t1-bottom", text1Y.value + "%");
      document.documentElement.style.setProperty("--t2-left", text2X.value + "%");
      document.documentElement.style.setProperty("--t2-bottom", text2Y.value + "%");
    }

    [fontSelect, textColorInput, textSizeInput].forEach(el =>
      el.addEventListener("input", applyParlayTextStyle)
    );
    [text1X, text1Y, text2X, text2Y].forEach(el =>
      el.addEventListener("input", applyParlayTextPositions)
    );
    applyParlayTextStyle();
    applyParlayTextPositions();

    // Parlay slip & player movement
    const slipX = document.getElementById("slip-x");
    const slipY = document.getElementById("slip-y");
    const slipWidth = document.getElementById("slip-width");
    const playerX = document.getElementById("player-x");
    const playerY = document.getElementById("player-y");
    const playerWidth = document.getElementById("player-width");

    function applySlip() {
      document.documentElement.style.setProperty("--slip-left", slipX.value + "%");
      document.documentElement.style.setProperty("--slip-top", slipY.value + "%");
      document.documentElement.style.setProperty("--slip-width", slipWidth.value + "%");
    }

    function applyPlayer() {
      document.documentElement.style.setProperty("--player-right", playerX.value + "%");
      document.documentElement.style.setProperty("--player-bottom", playerY.value + "%");
      document.documentElement.style.setProperty("--player-width", playerWidth.value + "%");
    }

    [slipX, slipY, slipWidth].forEach(el =>
      el.addEventListener("input", applySlip)
    );
    [playerX, playerY, playerWidth].forEach(el =>
      el.addEventListener("input", applyPlayer)
    );
    applySlip();
    applyPlayer();

    // Download
    function isMobile() {
      return /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
    }

    document.getElementById("download-btn").addEventListener("click", () => {
      html2canvas(sheet, { scale: 2 }).then(canvas => {
        const dataUrl = canvas.toDataURL("image/png");
        if (isMobile()) {
          const win = window.open("", "_blank");
          if (win) {
            win.document.write(
              '<html><head><title>Save image</title></head>' +
              '<body style="margin:0;background:#000;display:flex;align-items:center;justify-content:center;">' +
              '<img src="' + dataUrl + '" style="width:100%;height:auto;display:block;" />' +
              "</body></html>"
            );
            win.document.close();
            alert('In the new tab, longâ€‘press the image and choose "Save Image".');
          } else {
            window.location.href = dataUrl;
          }
        } else {
          const link = document.createElement("a");
          link.href = dataUrl;
          link.download = "bet-sheet.png";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        }
      });
    });
  </script>
</body>
</html>
