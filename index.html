<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Parlay + Player Builder (Phone)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Bebas font -->
  <link
    href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap"
    rel="stylesheet"
  />
  <style>
    :root {
      --bg: #05081a;
      --panel: #0b1023;
      --panel-soft: #141c3a;
      --accent: #ff6b3d;
      --accent-soft: #ff9c6d;
      --text: #f5f5f5;
      --muted: #94a3b8;
      --radius-lg: 16px;
      --radius-full: 999px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #182342 0, var(--bg) 55%);
      color: var(--text);
    }

    .app {
      max-width: 480px;
      margin: 0 auto;
      padding: 16px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    header {
      font-family: "Bebas Neue", system-ui, sans-serif;
      letter-spacing: 0.08em;
      font-size: 24px;
      text-transform: uppercase;
      text-align: left;
      padding: 8px 0;
    }

    .panel {
      background: radial-gradient(circle at top left, #1c2650, var(--panel));
      border-radius: var(--radius-lg);
      padding: 12px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.55);
    }

    .panel-title {
      font-size: 13px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
    }

    .field label {
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-size: 11px;
    }

    input[type="text"],
    input[type="number"],
    input[type="color"] {
      width: 100%;
      border-radius: 8px;
      border: none;
      padding: 6px 8px;
      background: rgba(15, 23, 42, 0.9);
      color: var(--text);
      font-size: 13px;
      outline: none;
    }

    input[type="text"]::placeholder {
      color: #64748b;
    }

    input[type="range"] {
      width: 100%;
    }

    .file-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .file-button {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 14px;
      border-radius: var(--radius-full);
      background: var(--panel-soft);
      color: var(--text);
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      cursor: pointer;
      border: 1px solid rgba(148, 163, 184, 0.25);
    }

    .file-button:hover {
      border-color: var(--accent-soft);
    }

    .file-button input[type="file"] {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer;
    }

    .preview-wrapper {
      background: #000;
      border-radius: var(--radius-lg);
      padding: 8px;
      margin-top: 6px;
    }

    /* The important bit: preview canvas uses the same aspect as export,
       no cropping, just scaled down */
    #previewCanvas {
      display: block;
      width: 100%;
      height: auto; /* keeps aspect ratio */
      border-radius: 12px;
      background: #020617;
    }

    .actions {
      margin-top: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    #downloadBtn {
      width: 100%;
      border: none;
      border-radius: var(--radius-full);
      background: linear-gradient(135deg, var(--accent), var(--accent-soft));
      color: #0f172a;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      padding: 12px;
      font-size: 13px;
      cursor: pointer;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
    }

    #downloadBtn:active {
      transform: translateY(1px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.7);
    }

    .hint {
      font-size: 11px;
      color: var(--muted);
      text-align: center;
      line-height: 1.4;
    }
  </style>
</head>
<body>
  <div class="app">
    <header>Parlay + Player (Phone)</header>

    <!-- TEXT CONTROLS -->
    <section class="panel">
      <div class="panel-title">Text</div>
      <div class="grid">
        <div class="field">
          <label for="text1">Top text</label>
          <input id="text1" type="text" placeholder="@LETSCASHSLIPS" />
        </div>
        <div class="field">
          <label for="text2">Bottom text</label>
          <input id="text2" type="text" placeholder="WEEK 13 PARLAYS" />
        </div>
        <div class="field">
          <label for="textColor">Text color</label>
          <input id="textColor" type="color" />
        </div>
        <div class="field">
          <label for="textSize">Text size</label>
          <input id="textSize" type="number" min="20" max="160" />
        </div>
      </div>

      <div class="grid" style="margin-top:8px;">
        <div class="field">
          <label for="t1x">T1 X</label>
          <input id="t1x" type="range" min="0" max="100" step="0.5" />
        </div>
        <div class="field">
          <label for="t1y">T1 Y</label>
          <input id="t1y" type="range" min="0" max="100" step="0.5" />
        </div>
        <div class="field">
          <label for="t2x">T2 X</label>
          <input id="t2x" type="range" min="0" max="100" step="0.5" />
        </div>
        <div class="field">
          <label for="t2y">T2 Y</label>
          <input id="t2y" type="range" min="0" max="100" step="0.5" />
        </div>
      </div>
    </section>

    <!-- IMAGE CONTROLS -->
    <section class="panel">
      <div class="panel-title">Images</div>
      <div class="file-buttons">
        <label class="file-button">
          BG image
          <input id="bgFile" type="file" accept="image/*" />
        </label>
        <label class="file-button">
          Parlay image
          <input id="slipFile" type="file" accept="image/*" />
        </label>
        <label class="file-button">
          Player PNG
          <input id="playerFile" type="file" accept="image/*" />
        </label>
      </div>

      <div class="grid" style="margin-top:8px;">
        <div class="field">
          <label for="slipX">Slip X</label>
          <input id="slipX" type="range" min="0" max="100" step="0.5" />
        </div>
        <div class="field">
          <label for="slipY">Slip Y</label>
          <input id="slipY" type="range" min="0" max="100" step="0.5" />
        </div>
        <div class="field">
          <label for="slipWidth">Slip width %</label>
          <input id="slipWidth" type="range" min="10" max="100" step="1" />
        </div>
        <div class="field">
          <label for="playerWidth">Player width %</label>
          <input id="playerWidth" type="range" min="10" max="100" step="1" />
        </div>
        <div class="field">
          <label for="playerX">Player X</label>
          <input id="playerX" type="range" min="0" max="100" step="0.5" />
        </div>
        <div class="field">
          <label for="playerY">Player Y</label>
          <input id="playerY" type="range" min="0" max="100" step="0.5" />
        </div>
      </div>
    </section>

    <!-- PREVIEW -->
    <section class="panel">
      <div class="panel-title">Preview (same as Download)</div>
      <div class="preview-wrapper">
        <!-- This canvas is BOTH the live preview and the exported image -->
        <canvas id="previewCanvas" width="1080" height="1920"></canvas>
      </div>

      <div class="actions">
        <button id="downloadBtn">Download image</button>
        <p class="hint">
          On iPhone/Android: after Download, long‑press the image in your Photos
          and choose “Save Image”.
        </p>
      </div>
    </section>
  </div>

  <script>
    // ------- STATE SETUP -------
    const canvas = document.getElementById("previewCanvas");
    const ctx = canvas.getContext("2d");

    const state = {
      text1: "@LETSCASHSLIPS",
      text2: "WEEK 13 PARLAYS",
      textColor: "#ffffff",
      textSize: 80,

      t1x: 6,
      t1y: 5,
      t2x: 6,
      t2y: 80,

      slipX: 5,
      slipY: 20,
      slipWidth: 52,

      playerX: 56,
      playerY: 22,
      playerWidth: 46,
    };

    const images = {
      bg: { img: new Image(), loaded: false },
      slip: { img: new Image(), loaded: false },
      player: { img: new Image(), loaded: false },
    };

    // ------- DRAW FUNCTION (used for preview AND final download) -------
    function draw() {
      const w = canvas.width;
      const h = canvas.height;

      // Clear and base background
      ctx.clearRect(0, 0, w, h);
      const grd = ctx.createLinearGradient(0, 0, 0, h);
      grd.addColorStop(0, "#020617");
      grd.addColorStop(1, "#020617");
      ctx.fillStyle = grd;
      ctx.fillRect(0, 0, w, h);

      // BG image stretched to fill canvas
      if (images.bg.loaded) {
        ctx.drawImage(images.bg.img, 0, 0, w, h);
      }

      // Parlay slip
      if (images.slip.loaded) {
        const slipW = (state.slipWidth / 100) * w;
        const ratio = images.slip.img.height / images.slip.img.width;
        const slipH = slipW * ratio;
        const slipX = (state.slipX / 100) * w;
        const slipY = (state.slipY / 100) * h;
        ctx.drawImage(images.slip.img, slipX, slipY, slipW, slipH);
      }

      // Player PNG
      if (images.player.loaded) {
        const playerW = (state.playerWidth / 100) * w;
        const ratio = images.player.img.height / images.player.img.width;
        const playerH = playerW * ratio;
        const playerX = (state.playerX / 100) * w;
        const playerY = (state.playerY / 100) * h;
        ctx.drawImage(images.player.img, playerX, playerY, playerW, playerH);
      }

      // Text
      ctx.fillStyle = state.textColor;
      ctx.textAlign = "left";
      ctx.textBaseline = "top";
      ctx.font = `${state.textSize}px 'Bebas Neue', sans-serif`;
      ctx.fillText(
        state.text1,
        (state.t1x / 100) * w,
        (state.t1y / 100) * h
      );

      ctx.font = `${state.textSize * 0.8}px 'Bebas Neue', sans-serif`;
      ctx.fillText(
        state.text2,
        (state.t2x / 100) * w,
        (state.t2y / 100) * h
      );
    }

    // ------- HELPERS -------
    function bindText(id, key) {
      const el = document.getElementById(id);
      el.value = state[key];
      el.addEventListener("input", () => {
        state[key] = el.value;
        draw();
      });
    }

    function bindRange(id, key) {
      const el = document.getElementById(id);
      el.value = state[key];
      el.addEventListener("input", () => {
        state[key] = parseFloat(el.value);
        draw();
      });
    }

    function handleFileInput(inputId, imageKey) {
      const input = document.getElementById(inputId);
      const obj = images[imageKey];

      input.addEventListener("change", (e) => {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (ev) => {
          obj.img.onload = () => {
            obj.loaded = true;
            draw();
          };
          obj.img.src = ev.target.result;
        };
        reader.readAsDataURL(file);
      });
    }

    // ------- BIND CONTROLS -------
    bindText("text1", "text1");
    bindText("text2", "text2");

    const textColorInput = document.getElementById("textColor");
    textColorInput.value = state.textColor;
    textColorInput.addEventListener("input", () => {
      state.textColor = textColorInput.value;
      draw();
    });

    const textSizeInput = document.getElementById("textSize");
    textSizeInput.value = state.textSize;
    textSizeInput.addEventListener("input", () => {
      const val = parseInt(textSizeInput.value, 10);
      if (!Number.isNaN(val)) {
        state.textSize = val;
        draw();
      }
    });

    [
      "t1x",
      "t1y",
      "t2x",
      "t2y",
      "slipX",
      "slipY",
      "slipWidth",
      "playerX",
      "playerY",
      "playerWidth",
    ].forEach((key) => bindRange(key, key));

    handleFileInput("bgFile", "bg");
    handleFileInput("slipFile", "slip");
    handleFileInput("playerFile", "player");

    // ------- DOWNLOAD -------
    document.getElementById("downloadBtn").addEventListener("click", () => {
      const link = document.createElement("a");
      link.download = "parlay.png";
      link.href = canvas.toDataURL("image/png");
      link.click();
    });

    // Initial draw
    draw();
  </script>
</body>
</html>
